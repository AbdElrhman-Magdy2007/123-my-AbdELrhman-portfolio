(()=>{var e={};e.id=1014,e.ids=[1014],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},21270:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>O,routeModule:()=>k,serverHooks:()=>b,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>q});var s={};r.r(s),r.d(s,{GET:()=>w,POST:()=>S});var a=r(96559),n=r(48088),o=r(37719),i=r(33169),c=r(19854),u=r.n(c),p=r(16144);class l{constructor(e){this.store=new Map,this.windowMs=e.windowMs,this.max=e.max}async check(e){let t=Date.now(),r=this.store.get(e);return!r||t>r.resetTime?(this.store.set(e,{count:1,resetTime:t+this.windowMs}),!1):r.count>=this.max||(r.count++,!1)}}var d=r(58111);let h={session:{strategy:"jwt",maxAge:604800,updateAge:86400},security:{maxAge:604800,secure:"production"===d.B5.PROD,sameSite:"lax",path:"/"},cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}},callbackUrl:{name:"__Secure-next-auth.callback-url",options:{sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}},csrfToken:{name:"__Host-next-auth.csrf-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}}},limits:{maxLoginAttempts:5,lockoutDuration:9e5,passwordMinLength:8,passwordMaxLength:128},messages:{errors:{configuration:"خطأ في إعدادات المصادقة. يرجى التحقق من ملف .env.local",accessDenied:"تم رفض الوصول. يرجى تسجيل الدخول أولاً",verification:"فشل التحقق من البريد الإلكتروني",default:"حدث خطأ غير متوقع"}}},f=new l({windowMs:9e5,max:100}),m={"X-Frame-Options":"DENY","X-Content-Type-Options":"nosniff","Referrer-Policy":"strict-origin-when-cross-origin","Strict-Transport-Security":"max-age=63072000; includeSubDomains; preload","X-XSS-Protection":"1; mode=block","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"},x=(e,t=500,r)=>new Response(JSON.stringify({error:e,details:r,timestamp:new Date().toISOString()}),{status:t,headers:{"Content-Type":"application/json","Cache-Control":"no-store, max-age=0",...m}}),g=u()({...i.N,pages:{...i.N.pages,error:"/auth/error"},callbacks:{...i.N.callbacks,redirect:async({url:e,baseUrl:t})=>e.startsWith(t)?e:e.startsWith("/")?`${t}${e}`:t}});async function y(e,t){try{let r=e.headers.get("x-forwarded-for")||"unknown";if(await f.check(r))return x("Too many requests",429);if(!["GET","POST"].includes(e.method))return x("Method not allowed",405);if("POST"===e.method){let t=e.headers.get("content-type");if(!t?.includes("application/json"))return x("Invalid content type",415)}return await t(e)}catch(e){return x(h.messages.errors.default)}}async function w(e){return y(e,async e=>{try{let t=await g(e);return Object.entries(m).forEach(([e,r])=>{t.headers.set(e,r)}),t}catch(e){if(e instanceof Error&&e.message.includes("configuration"))return x(h.messages.errors.configuration,500,{error:e.message});return x(h.messages.errors.default)}})}async function S(e){return y(e,async t=>{try{let e=await t.json(),r=(0,p.X5)().safeParse(e);if(!r.success)return x("Invalid request data",400,r.error.format());let s=await g(t);return Object.entries(m).forEach(([e,t])=>{s.headers.set(e,t)}),s}catch(a){let t=h.messages.errors.default,r={};if(a instanceof Error)try{let e=JSON.parse(a.message);e.validationError?(t="خطأ في التحقق من الصحة",r={validation:e.validationError}):t=e.responseError?e.responseError:a.message.includes("configuration")?"خطأ في تكوين المصادقة":a.message}catch(e){t=a.message.includes("configuration")?"خطأ في تكوين المصادقة":a.message}let s=new URL("/auth/error",e.url);return s.searchParams.set("error","CredentialsSignin"),s.searchParams.set("message",t),Object.keys(r).length>0&&s.searchParams.set("details",JSON.stringify(r)),new Response(null,{status:302,headers:{Location:s.toString(),...m}})}})}let k=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy - Copy - Copy - Copy (2)\\src\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:v,workUnitAsyncStorage:q,serverHooks:b}=k;function O(){return(0,o.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:q})}},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33319:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"60c2cce2666aecb6e3c810db16e90500f01296191a":()=>s.i,"60fd39a9db53f8dabdc4924f0cb505f442d509acdb":()=>s.$});var s=r(62288)},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{},96559:(e,t,r)=>{"use strict";e.exports=r(44870)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,6915,5912,8172,3169],()=>r(21270));module.exports=s})();