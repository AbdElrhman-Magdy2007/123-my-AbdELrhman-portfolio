(()=>{var e={};e.id=14,e.ids=[14],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},23444:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"600eddcdcbfee75212786e8a798ab5803206ce3e5c":()=>s.$,"6044ac343193b6006fa5ace3a30ee6b8011f3d6598":()=>s.i});var s=r(62288)},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},96186:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>O,routeModule:()=>q,serverHooks:()=>b,workAsyncStorage:()=>S,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>w,POST:()=>k});var a=r(96559),n=r(48088),o=r(37719),i=r(33169),u=r(19854),c=r.n(u),p=r(16144);class l{constructor(e){this.store=new Map,this.windowMs=e.windowMs,this.max=e.max}async check(e){let t=Date.now(),r=this.store.get(e);return!r||t>r.resetTime?(this.store.set(e,{count:1,resetTime:t+this.windowMs}),!1):r.count>=this.max||(r.count++,!1)}}var d=r(58111);let h={session:{strategy:"jwt",maxAge:604800,updateAge:86400},security:{maxAge:604800,secure:"production"===d.B5.PROD,sameSite:"lax",path:"/"},cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}},callbackUrl:{name:"__Secure-next-auth.callback-url",options:{sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}},csrfToken:{name:"__Host-next-auth.csrf-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:"production"===d.B5.PROD}}},limits:{maxLoginAttempts:5,lockoutDuration:9e5,passwordMinLength:8,passwordMaxLength:128},messages:{errors:{configuration:"خطأ في إعدادات المصادقة. يرجى التحقق من ملف .env.local",accessDenied:"تم رفض الوصول. يرجى تسجيل الدخول أولاً",verification:"فشل التحقق من البريد الإلكتروني",default:"حدث خطأ غير متوقع"}}},f=new l({windowMs:9e5,max:100}),x={"X-Frame-Options":"DENY","X-Content-Type-Options":"nosniff","Referrer-Policy":"strict-origin-when-cross-origin","Strict-Transport-Security":"max-age=63072000; includeSubDomains; preload","X-XSS-Protection":"1; mode=block","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"},m=(e,t=500,r)=>new Response(JSON.stringify({error:e,details:r,timestamp:new Date().toISOString()}),{status:t,headers:{"Content-Type":"application/json","Cache-Control":"no-store, max-age=0",...x}}),g=c()({...i.N,pages:{...i.N.pages,error:"/auth/error"},callbacks:{...i.N.callbacks,redirect:async({url:e,baseUrl:t})=>e.startsWith(t)?e:e.startsWith("/")?`${t}${e}`:t}});async function y(e,t){try{let r=e.headers.get("x-forwarded-for")||"unknown";if(await f.check(r))return m("Too many requests",429);if(!["GET","POST"].includes(e.method))return m("Method not allowed",405);if("POST"===e.method){let t=e.headers.get("content-type");if(!t?.includes("application/json"))return m("Invalid content type",415)}return await t(e)}catch(e){return m(h.messages.errors.default)}}async function w(e){return y(e,async e=>{try{let t=await g(e);return Object.entries(x).forEach(([e,r])=>{t.headers.set(e,r)}),t}catch(e){if(e instanceof Error&&e.message.includes("configuration"))return m(h.messages.errors.configuration,500,{error:e.message});return m(h.messages.errors.default)}})}async function k(e){return y(e,async e=>{try{let t=await e.json(),r=(0,p.X5)().safeParse(t);if(!r.success)return m("Invalid request data",400,r.error.format());let s=await g(e);return Object.entries(x).forEach(([e,t])=>{s.headers.set(e,t)}),s}catch(e){if(e instanceof Error&&e.message.includes("configuration"))return m(h.messages.errors.configuration,500,{error:e.message});return m(h.messages.errors.default)}})}let q=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy - Copy - Copy\\src\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:S,workUnitAsyncStorage:v,serverHooks:b}=q;function O(){return(0,o.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:v})}},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{},96559:(e,t,r)=>{"use strict";e.exports=r(44870)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[243,915,172,169],()=>r(96186));module.exports=s})();