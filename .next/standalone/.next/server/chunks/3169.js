"use strict";exports.id=3169,exports.ids=[3169],exports.modules={16144:(e,r,s)=>{s.d(r,{O5:()=>n,X5:()=>o});var a=s(45697);let t={requiredEmail:"Email is required",validEmail:"Invalid email format",requiredPassword:"Password is required",passwordMinLength:"Password must be at least 6 characters",passwordMaxLength:"Password must be less than 40 characters",requiredName:"Name is required",nameMaxLength:"Name must be less than 50 characters",requiredConfirmPassword:"Password confirmation is required",passwordsDoNotMatch:"Passwords do not match",validLimit:"Limit must be a positive integer",limitMax:"Limit must be 100 or less"},i=e=>({isValid:e.password===e.confirmPassword,error:{message:t.passwordsDoNotMatch,path:["confirmPassword"]}}),o=()=>a.z.object({email:a.z.string().trim().min(1,{message:t.requiredEmail}).email({message:t.validEmail}).transform(e=>e.toLowerCase()),password:a.z.string().min(1,{message:t.requiredPassword}).min(6,{message:t.passwordMinLength}).max(40,{message:t.passwordMaxLength})}).strict(),n=()=>a.z.object({name:a.z.string().trim().min(1,{message:t.requiredName}).max(50,{message:t.nameMaxLength}),email:a.z.string().trim().min(1,{message:t.requiredEmail}).email({message:t.validEmail}).transform(e=>e.toLowerCase()),password:a.z.string().min(1,{message:t.requiredPassword}).min(6,{message:t.passwordMinLength}).max(40,{message:t.passwordMaxLength}),confirmPassword:a.z.string().min(1,{message:t.requiredConfirmPassword}),limit:a.z.number().int().min(1,{message:t.validLimit}).max(100,{message:t.limitMax}).default(1).optional()}).refine(e=>i(e).isValid,e=>i(e).error)},31183:(e,r,s)=>{s.d(r,{db:()=>t});var a=s(96330);let t=globalThis.prisma||new a.PrismaClient({log:["query","info","warn","error"]});t.$connect().then(()=>console.log("âœ… Prisma connected successfully")).catch(e=>{throw e})},33169:(e,r,s)=>{s.d(r,{N:()=>m});var a=s(58111),t=s(13581),i=s(60890),o=s(31183),n=s(62288);let d=["NEXTAUTH_URL","NEXTAUTH_SECRET"].filter(e=>!process.env[e]);if(d.length>0)throw Error(`Missing required environment variables: ${d.join(", ")}. Please check your .env file and ensure all required variables are set.`);let m={adapter:(0,i.y)(o.db),providers:[(0,t.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"example@email.com"},password:{label:"Password",type:"password"}},async authorize(e){try{if(!e?.email||!e?.password)throw Error(JSON.stringify({validationError:{email:["Email is required"],password:["Password is required"]}}));let r=await (0,n.i)(e,a.AT.ENGLISH);if(200===r.status&&r.user)return{id:r.user.id,name:r.user.name,email:r.user.email,role:r.user.role};throw Error(JSON.stringify({validationError:r.error,responseError:r.message}))}catch(e){throw e}}})],callbacks:{async jwt({token:e,user:r}){try{if(r)return{...e,id:r.id,name:r.name,email:r.email,role:r.role};if(!e.email)return e;let s=await o.db.user.findUnique({where:{email:e.email},select:{id:!0,name:!0,email:!0,role:!0,image:!0,phone:!0,country:!0,city:!0,postalCode:!0,streetAddress:!0}});if(!s)return e;return{...e,id:s.id,name:s.name,email:s.email,role:s.role,image:s.image,phone:s.phone,country:s.country,city:s.city,postalCode:s.postalCode,streetAddress:s.streetAddress}}catch(r){return e}},async session({session:e,token:r}){try{return r&&(e.user={id:r.id,name:r.name,email:r.email,role:r.role,image:r.image,phone:r.phone,country:r.country,city:r.city,postalCode:r.postalCode,streetAddress:r.streetAddress}),e}catch(r){return e}},redirect:async({url:e,baseUrl:r})=>e.startsWith("/api/auth")||e.startsWith(`/${a.BV.AUTH}`)?e:r},session:{strategy:"jwt",maxAge:604800,updateAge:86400},pages:{signIn:`/${a.BV.AUTH}${a.bQ.LOGIN}`,error:`/${a.BV.AUTH}/${a.bQ.ERROR}`,signOut:`/${a.BV.AUTH}/${a.bQ.LOGOUT}`,verifyRequest:`/${a.BV.AUTH}/${a.bQ.VERIFY_REQUEST}`},secret:"60d665bff7695e6de1f0528f2d43376489f244dacf8f098279c870109ceac7c6",debug:"production"===a.B5.DEV}},58111:(e,r,s)=>{s.d(r,{AT:()=>a,B5:()=>o,BV:()=>t,bQ:()=>i});var a=function(e){return e.ENGLISH="en",e.ARABIC="ar",e}({}),t=function(e){return e.ROOT="",e.MENU="menu",e.ABOUT="about",e.CONTACT="contact",e.AUTH="auth",e.CART="cart",e.PROFILE="profile",e.ADMIN="admin",e.PORTFOLIO="PORTFOLIO",e.SETTINGS="SETTINGS",e}({}),i=function(e){return e.LOGIN="/signin",e.Register="/signup",e.ERROR="error",e.FORGOT_PASSWORD="forgot-password",e.CATEGORIES="categories",e.MENU_ITEMS="menu-items",e.USERS="users",e.ORDERS="orders",e.NEW="new",e.EDIT="edit",e.DASHBOARD="Dashboard",e.CUSTOMERS="Customers",e.SALES="Sales",e.PRODUCTS="PRODUCTS",e.LOGOUT="LOGOUT",e.VERIFY_REQUEST="verify-request",e}({}),o=function(e){return e.PROD="production",e.DEV="development",e}({})},62288:(e,r,s)=>{s.d(r,{$:()=>g,i:()=>c});var a=s(67218);s(79130);var t=s(31183),i=s(5486),o=s.n(i),n=s(58111),d=s(62351),m=s(84113),l=s(16144),u=s(96330);async function c(e,r){try{if(!e?.email||!e?.password)return{status:400,message:"Email and password are required",className:"text-red-500"};let r=(0,l.X5)().safeParse(e);if(!r.success)return{status:400,error:r.error.formErrors.fieldErrors,className:"text-red-500"};let s=await t.db.user.findUnique({where:{email:e.email}});if(!s||!await o().compare(e.password,s.password))return{status:401,message:"Invalid email or password",className:"text-red-500"};return{status:200,user:{id:s.id,name:s.name,email:s.email,role:s.role}}}catch(e){return{status:500,message:"An unexpected error occurred during login",error:e instanceof Error?e.message:"Unknown error",className:"text-red-500"}}}async function g(e,r){let s=Object.fromEntries(r.entries()),a=(0,l.O5)().safeParse(s);if(!a.success)return{status:400,error:a.error.formErrors.fieldErrors,formData:r,className:"text-red-500"};try{if(await t.db.user.findUnique({where:{email:a.data.email},select:{id:!0}}))return{status:409,message:"User already exists",formData:r,className:"text-red-500"};let e=await o().hash(a.data.password,10),s=await t.db.user.create({data:{id:(0,m.A)(),name:a.data.name,email:a.data.email,password:e,role:"USER"},select:{id:!0,name:!0,email:!0,role:!0}}),i=`/${n.BV.ADMIN}`;return(0,d.revalidatePath)(`${i}/${n.bQ.USERS}/${s.id}/${n.bQ.EDIT}`),(0,d.revalidatePath)(`${i}/${n.bQ.USERS}`),{status:201,message:"Registration successful",user:s,className:"text-green-500"}}catch(e){return{status:500,message:"An unexpected error occurred",error:e instanceof u.Prisma.PrismaClientKnownRequestError?`Prisma error: ${e.code} - ${e.message}`:e instanceof Error?e.message:"Unknown error",className:"text-red-500"}}}(0,s(17478).D)([c,g]),(0,a.A)(c,"60c2cce2666aecb6e3c810db16e90500f01296191a",null),(0,a.A)(g,"60fd39a9db53f8dabdc4924f0cb505f442d509acdb",null)}};